<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Adhésion – Etape 1</title>

<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
<link rel="stylesheet" th:href="@{/css/ft-theme.min.css}">

</head>
<body>

	<div class="ft-shell">
		<div th:replace="fragments/layout :: appHeader('Adhésion – Etape 1')"></div>

		<div class="container py-5">
			<div class="card shadow-sm mx-auto" style="max-width: 980px;">
				<div class="card-body p-4">

					<!-- Bandeau wizard -->
					<div class="d-flex justify-content-between align-items-start mb-3">
						<div>
							<h3 class="mb-1">Adhésion El Fatoora</h3>
							<div class="text-muted small">
								<span th:if="${wiz != null && wiz.dossierRef != null}">
									Référence : <b th:text="${wiz.dossierRef}">ELF-ADH-...</b>
								</span> <span th:if="${wiz != null && wiz.dossierRef == null}">
									Référence : <span class="text-muted">non générée</span>
								</span>
							</div>
							<div class="text-muted">Etape 1 / 6 – Identification de
								l’opérateur économique</div>
						</div>
					</div>

					<div class="alert alert-danger" th:if="${error != null}"
						th:text="${error}"></div>

					<!-- Display all validation errors -->
                    <div class="alert alert-danger" th:if="${#fields.hasErrors('*')}">
                        <p>Veuillez corriger les erreurs suivantes :</p>
                        <ul>
                            <li th:each="err : ${#fields.errors('*')}" th:text="${err}"></li>
                        </ul>
                    </div>

					<form th:action="@{/adhesion/etape1}" method="post"
						th:object="${wiz}" class="ft-validate">
						<h6 class="mb-3">Informations générales</h6>
						
						
<div class="mb-4">
  <div class="d-flex align-items-center gap-2 mb-2">
    <h6 class="mb-0">Forme juridique</h6>
  </div>

  <div class="row g-3">
    <div class="col-md-6">
      <label class="w-100">
        <input class="form-check-input visually-hidden"
               type="radio"
               th:field="*{formeJuridique}"
               value="MORALE"
               id="fjMorale">
        <div class="border rounded-4 p-3 h-100 d-flex align-items-start gap-3 ef-fj-card" data-target="MORALE">
          <div class="pt-1">
            <span class="ef-radio-dot"></span>
          </div>
          <div>
            <div class="fw-semibold">Personne Morale</div>
            <div class="text-muted small">Société (SARL, SUARL, SA)</div>
          </div>
        </div>
      </label>
    </div>

    <div class="col-md-6">
      <label class="w-100">
        <input class="form-check-input visually-hidden"
               type="radio"
               th:field="*{formeJuridique}"
               value="PHYSIQUE"
               id="fjPhysique">
        <div class="border rounded-4 p-3 h-100 d-flex align-items-start gap-3 ef-fj-card" data-target="PHYSIQUE">
          <div class="pt-1">
            <span class="ef-radio-dot"></span>
          </div>
          <div>
            <div class="fw-semibold">Personne Physique</div>
            <div class="text-muted small">Individu (Patente propre)</div>
          </div>
        </div>
      </label>
    </div>
  </div>
</div>
					
						<div class="row g-4 ef-form-grid">

<!-- Personne Morale : Raison sociale -->
<div class="col-md-6" id="blocRaisonSociale">
  <div class="ef-field">
    <div class="ef-label-row">
      <label class="ef-mini-label">Raison sociale</label>
      <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-html="true" data-bs-trigger="hover focus" th:title="|...|">?</button>
    </div>
    <input class="form-control ft-input" id="raisonSocialeInput" th:field="*{raisonSociale}" placeholder="Raison sociale" th:classappend="${#fields.hasErrors('raisonSociale')} ? 'is-invalid' : ''" required>
    <div class="invalid-feedback" th:if="${#fields.hasErrors('raisonSociale')}" th:errors="*{raisonSociale}"></div>
  </div>
</div>

<!-- Personne Physique : Nom + Prénom -->
<div class="col-md-6 d-none" id="blocNomPrenom">
  <div class="row g-4">
    <div class="col-md-6">
      <div class="ef-field">
        <div class="ef-label-row">
          <label class="ef-mini-label">Nom</label>
          <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Nom (tel qu'indiqué sur la CIN ou carte de séjour).">?</button>
        </div>
        <input class="form-control ft-input" id="nomInput" th:field="*{nomPersonnePhysique}" placeholder="Nom" th:classappend="${#fields.hasErrors('nomPersonnePhysique')} ? 'is-invalid' : ''">
        <div class="invalid-feedback" th:if="${#fields.hasErrors('nomPersonnePhysique')}" th:errors="*{nomPersonnePhysique}"></div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="ef-field">
        <div class="ef-label-row">
          <label class="ef-mini-label">Prénom</label>
          <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Prénom (tel qu'indiqué sur la CIN).">?</button>
        </div>
        <input class="form-control ft-input" id="prenomInput" th:field="*{prenomPersonnePhysique}" placeholder="Prénom" th:classappend="${#fields.hasErrors('prenomPersonnePhysique')} ? 'is-invalid' : ''">
        <div class="invalid-feedback" th:if="${#fields.hasErrors('prenomPersonnePhysique')}" th:errors="*{prenomPersonnePhysique}"></div>
      </div>
    </div>
  </div>
</div>

<div class="col-md-6">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">N° RNE - Registre National des Entreprises</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-html="true" data-bs-trigger="hover focus" th:title="|...|">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{registreCommerce}" placeholder="N° Registre de commerce" th:classappend="${#fields.hasErrors('registreCommerce')} ? 'is-invalid' : ''" required>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('registreCommerce')}" th:errors="*{registreCommerce}"></div>
    </div>
</div>

<div class="col-md-4">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Matricule fiscal</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-html="true" data-bs-trigger="hover focus" th:title="|...|">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{matriculeFiscal}" placeholder="Matricule fiscal" th:classappend="${#fields.hasErrors('matriculeFiscal')} ? 'is-invalid' : ''" autocapitalize="characters" spellcheck="false" oninput="this.value=(this.value||'').toUpperCase();">
        <div class="form-text">Format : 7 chiffres + 1 lettre (ex : 1234567A).</div>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('matriculeFiscal')}" th:errors="*{matriculeFiscal}"></div>
    </div>
</div>

<div class="col-md-2">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Code TVA</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-html="true" data-bs-trigger="hover focus" th:title="|...|">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{codeTVA}" placeholder="Code TVA">
    </div>
</div>

<div class="col-md-3">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Code catégorie</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-html="true" data-bs-trigger="hover focus" th:title="|...|">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{codeCategorie}" placeholder="Code catégorie">
    </div>
</div>

<div class="col-md-3">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">N° Etab secondaire</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-html="true" data-bs-trigger="hover focus" th:title="|...|">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{etabSecondaire}" placeholder="N° Etab secondaire">
    </div>
</div>

<div class="col-md-4">
  <div class="ef-field">
    <div class="ef-label-row">
      <label class="ef-mini-label">Secteur activité</label>                 
      <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-html="true" data-bs-trigger="hover focus" th:title="|...|">?</button>
    </div>
    <input class="form-control ft-input" th:field="*{secteurActivite}" placeholder="Secteur activité" th:classappend="${#fields.hasErrors('secteurActivite')} ? 'is-invalid' : ''" required>
    <div class="invalid-feedback" th:if="${#fields.hasErrors('secteurActivite')}" th:errors="*{secteurActivite}"></div>
  </div>
</div>

<div class="col-md-8">
  <div class="ef-field">
    <div class="ef-label-row">
      <label class="ef-mini-label">Adresse complète</label>
      <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-html="true" data-bs-trigger="hover focus" th:title="|...|">?</button>
    </div>
    <input class="form-control ft-input" th:field="*{adresse}" placeholder="Adresse complète" th:classappend="${#fields.hasErrors('adresse')} ? 'is-invalid' : ''" required>
    <div class="invalid-feedback" th:if="${#fields.hasErrors('adresse')}" th:errors="*{adresse}"></div>
  </div>
</div>

<div class="col-md-3">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Code postal</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Code postal (optionnel).">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{codePostal}" placeholder="Code postal" th:classappend="${#fields.hasErrors('codePostal')} ? 'is-invalid' : ''" required>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('codePostal')}" th:errors="*{codePostal}"></div>
    </div>
</div>

<div class="col-md-4">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Gouvernorat</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Sélectionner le gouvernorat.">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{gouvernorat}" id="govInput" list="govList" placeholder="Gouvernorat" th:classappend="${#fields.hasErrors('gouvernorat')} ? 'is-invalid' : ''" required>
        <datalist id="govList">
            <!-- options -->
        </datalist>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('gouvernorat')}" th:errors="*{gouvernorat}"></div>
    </div>
</div>

<div class="col-md-5">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Ville</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Ville correspondant au gouvernorat.">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{ville}" id="villeInput" list="villeList" placeholder="Ville" th:classappend="${#fields.hasErrors('ville')} ? 'is-invalid' : ''" required>
        <datalist id="villeList"></datalist>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('ville')}" th:errors="*{ville}"></div>
    </div>
</div>

<div class="col-md-4">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Téléphone</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Téléphone de contact.">?</button>
        </div>
        <input class="form-control ft-input" th:field="*{telephone}" placeholder="Téléphone" th:classappend="${#fields.hasErrors('telephone')} ? 'is-invalid' : ''" required>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('telephone')}" th:errors="*{telephone}"></div>
    </div>
</div>

<div class="col-md-8">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Email général</label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Email principal de communication.">?</button>
        </div>
        <input class="form-control ft-input" type="email" th:field="*{emailGeneral}" placeholder="Email général" th:classappend="${#fields.hasErrors('emailGeneral')} ? 'is-invalid' : ''" required>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('emailGeneral')}" th:errors="*{emailGeneral}"></div>
    </div>
</div>

<div class="col-12">
    <div class="ef-field">
        <div class="ef-label-row">
            <label class="ef-mini-label">Email facturation </label>
            <button type="button" class="ef-help-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Email utilisé pour les notifications de facturation.">?</button>
        </div>
        <input class="form-control ft-input" type="email" th:field="*{emailFacturation}" placeholder="Email facturation " th:classappend="${#fields.hasErrors('emailFacturation')} ? 'is-invalid' : ''">
        <div class="invalid-feedback" th:if="${#fields.hasErrors('emailFacturation')}" th:errors="*{emailFacturation}"></div>
    </div>
</div>

						</div>

						<div class="d-flex justify-content-between mt-4">
							<a class="btn btn-outline-secondary" th:href="@{/adhesion}">Retour</a>
							<button type="submit" class="btn btn-primary">Suivant</button>
						</div>
					</form>

				</div>
			</div>
		</div>


		<div th:replace="fragments/layout :: appFooter"></div>
	</div>
	<script th:src="@{/js/ft-theme.js}"></script>
	
	
<div id="imageZoomModal" class="modal fade" tabindex="-1" style="background: rgba(0,0,0,0.8);">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content" style="background: transparent; border: none;">
      <div class="modal-body text-center">
        <img id="zoomedImage" src="" class="img-fluid rounded shadow-lg">
      </div>
    </div>
  </div>
</div>
	
</body>
</html>
