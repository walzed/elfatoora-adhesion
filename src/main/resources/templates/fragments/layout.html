<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>

	<!-- =======================================================
     HEAD fragment (à utiliser dans toutes les pages)
======================================================= -->
	<th:block th:fragment="appHead(pageTitle)">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title th:text="${pageTitle}">El Fatoora</title>

		<link rel="shortcut icon" th:href="@{/favicon.ico}">
		<link rel="icon" type="image/png" sizes="16x16" th:href="@{/favicon/favicon-16x16.png}">
		<link rel="icon" type="image/png" sizes="32x32" th:href="@{/favicon/favicon-32x32.png}">
		<link rel="apple-touch-icon" sizes="180x180" th:href="@{/favicon/apple-touch-icon.png}">
		<link rel="manifest" th:href="@{/favicon/site.webmanifest}">
		<meta name="theme-color" content="#27306d">

		<link rel="preload" th:href="@{/fonts/roboto-400.woff2}" as="font" type="font/woff2" crossorigin>
		<link rel="preload" th:href="@{/fonts/roboto-700.woff2}" as="font" type="font/woff2" crossorigin>

		<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">

		<link rel="stylesheet" th:href="@{/css/roboto.css}">

		<link rel="stylesheet" th:href="@{/css/ft-theme.min.css}">
	</th:block>

	<!-- =======================================================
     HEADER 
======================================================= -->
	<header class="ft-topbar" th:fragment="appHeader(title)">
		<div class="ft-topbar-inner">

	<!-- Brand (MF + TTN) -->
	<div class="ft-brand">
	
	  <!-- Logo MF (SVG complet avec texte) -->
	  <a th:href="@{/}" class="ft-brand-link" aria-label="Accueil - Ministère des Finances">
	    <img th:src="@{/img/mf-logo.svg}" alt="République Tunisienne - Ministère des Finances"
	         class="ft-logo-mf">
	  </a>
	
	  <div class="ft-sep" aria-hidden="true"></div>
	
	  <!-- Bloc El Fatoora / TTN -->
	  <a th:href="@{/}" class="ft-brand-link" aria-label="Accueil - Tunisie TradeNet">
	    <div class="ft-brand-ttn">
	      <img th:src="@{/img/elfatoora-logo.svg}" alt="El Fatoora"
	           class="ft-logo-elfatoora">
	      <img th:src="@{/img/ttn-logo.png}" alt="TTN - Tunisie TradeNet"
	           class="ft-logo-ttn">
	    </div>
	  </a>
	
	</div>


			<!-- Right actions -->
			<div class="ft-actions">
				<button class="ft-icon-btn" type="button" aria-label="Rechercher"
					onclick="return false;">
					<svg class="ft-icon" viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="11" cy="11" r="7"></circle>
          <path d="M20 20l-3.5-3.5"></path>
        </svg>
				</button>

				<a class="ft-icon-btn" th:href="@{/myspace/notifications}"
					sec:authorize="hasRole('CLIENT')" aria-label="Notifications"> <svg
						class="ft-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M18 8a6 6 0 10-12 0c0 7-3 7-3 7h18s-3 0-3-7"></path>
          <path d="M13.73 21a2 2 0 01-3.46 0"></path>
        </svg>
				</a>

				<!-- Connexion si anonyme -->
				<a class="ft-login-link" th:href="@{/auth/login}"
					sec:authorize="isAnonymous()">Connexion</a>

				<!-- Menu utilisateur (dropdown) si authentifié -->
				<div class="ft-user-dropdown dropdown"
					sec:authorize="isAuthenticated()">
					<button class="ft-user-btn" type="button" id="userMenu"
						data-bs-toggle="dropdown" aria-expanded="false">
						<div class="ft-user-avatar">
							<span
								th:text="${#strings.substring(#authentication.name, 0, 1).toUpperCase()}">U</span>
						</div>
						<span class="ft-user-name d-none d-sm-inline"
							sec:authentication="name">Utilisateur</span>
						<svg class="ft-chevron" viewBox="0 0 24 24" fill="none"
							stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
							stroke-linejoin="round">
							<path d="m6 9 6 6 6-6" /></svg>
					</button>

					<ul class="dropdown-menu dropdown-menu-end ft-dropdown-card"
						aria-labelledby="userMenu">
						<li class="dropdown-header">
							<div class="ft-user-info-detail">
								<strong sec:authentication="name">Utilisateur</strong> <span
									class="badge bg-light text-dark border mt-1"
									style="font-size: 10px;">Connecté</span>
							</div>
						</li>

						<li><hr class="dropdown-divider"></li>

						<li sec:authorize="hasRole('CLIENT')">
						
						  <!-- Ligne principale : Mon espace -->
						  <a class="dropdown-item d-flex align-items-center gap-2"
						     th:href="@{/myspace}">
						    <svg class="ft-menu-icon" viewBox="0 0 24 24" fill="none"
						         stroke="currentColor" stroke-width="2" stroke-linecap="round"
						         stroke-linejoin="round" aria-hidden="true">
						      <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
						      <circle cx="12" cy="7" r="4" />
						    </svg>
						    <span class="fw-semibold">Mon espace</span>
						  </a>
						
						  <!-- Sous-liens : Démarrer/Reprendre + Suivre -->
						  <div class="px-3 pb-2 pt-1">
						
						    <a class="dropdown-item small ps-4 d-flex align-items-center gap-2"
						       th:href="@{/adhesion/etape1}">
						      <!-- Icône "démarrer/reprendre" : Play / Start -->
						      <svg class="ft-menu-icon" viewBox="0 0 24 24" fill="none"
						           stroke="currentColor" stroke-width="2" stroke-linecap="round"
						           stroke-linejoin="round" aria-hidden="true">
						        <polygon points="8 5 19 12 8 19 8 5"></polygon>
						      </svg>
						      <span>Démarrer / Reprendre Demande</span>
						    </a>
						
						    <a class="dropdown-item small ps-4 d-flex align-items-center gap-2"
						       th:href="@{/adhesion/suivi}">
						      <!-- Icône "suivre" : Target / Tracking -->
						      <svg class="ft-menu-icon" viewBox="0 0 24 24" fill="none"
						           stroke="currentColor" stroke-width="2" stroke-linecap="round"
						           stroke-linejoin="round" aria-hidden="true">
						        <circle cx="12" cy="12" r="8"></circle>
						        <circle cx="12" cy="12" r="2"></circle>
						        <path d="M12 2v2"></path>
						        <path d="M12 20v2"></path>
						        <path d="M2 12h2"></path>
						        <path d="M20 12h2"></path>
						      </svg>
						      <span>Suivre Demande</span>
						    </a>
						
						  </div>
						</li>
 
						<li sec:authorize="hasRole('AGENT_TTN')"><a
							class="dropdown-item" th:href="@{/bo/dossiers}"> <svg
									class="ft-menu-icon" viewBox="0 0 24 24" fill="none"
									stroke="currentColor" stroke-width="2" stroke-linecap="round"
									stroke-linejoin="round">
									<rect x="3" y="3" width="18" height="18" rx="2" />
									<path d="M9 3v18" />
									<path d="m14 8 2 2-2 2" />
									<path d="m19 8-2 2 2 2" /></svg> Back office
						</a></li>


						<li><hr class="dropdown-divider"></li>
						
						<li sec:authorize="hasRole('CLIENT')">
						  <a class="dropdown-item d-flex align-items-center gap-2"
						     th:href="@{/adhesion/mes-brouillons}">
						    <svg class="ft-menu-icon" viewBox="0 0 24 24" fill="none"
						         stroke="currentColor" stroke-width="2" stroke-linecap="round"
						         stroke-linejoin="round" aria-hidden="true">
						      <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
						      <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
						    </svg>
						    <span>Mes brouillons</span>
						  </a>
						</li>

						<li><hr class="dropdown-divider"></li>

						<li>
							<form th:action="@{/logout}" method="post" class="m-0">
								<input type="hidden" th:if="${_csrf != null}"
									th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
								<button type="submit"
									class="dropdown-item text-danger border-0 bg-transparent w-100">
									<svg class="ft-menu-icon" viewBox="0 0 24 24" fill="none"
										stroke="currentColor" stroke-width="2" stroke-linecap="round"
										stroke-linejoin="round">
										<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
										<polyline points="16 17 21 12 16 7" />
										<line x1="21" y1="12" x2="9" y2="12" /></svg>
									Déconnexion
								</button>
							</form>
						</li>
					</ul>
				</div>




			</div>
		</div>
	</header>


	<!-- =======================================================
     FOOTER 
     =================================================== -->
	<footer class="ft-footer" th:fragment="appFooter">
	
	  <div class="ft-footer-copy">Tunisie TradeNet - El Fatoora 2026 ©</div>

	  <div class="ft-footer-links">
	    <a class="ft-footer-link" th:href="@{/cgu/infos-legales}">
	      <span>Informations Légales</span>
	    </a>
	
	    <a class="ft-footer-link" th:href="@{/cgu/donnees-personnelles}">
	      <span>Protections des Données Personnelles</span>
	    </a>
	
	    <a class="ft-footer-link" th:href="@{/cgu/conditions-generales}">
	      <span>Conditions Générales d'Utilisation</span>
	    </a>
	    
	  </div>
	
	<!-- Loader global -->
	<div id="ftLoader" class="ft-loader" aria-hidden="true" hidden>
	  <div class="ft-loader-backdrop"></div>
	  <div class="ft-loader-content" role="status" aria-live="polite">
	    <img class="ft-loader-logo" th:src="@{/img/elfatoora-logo.svg}" alt="El Fatoora">
	    <div id="ftLoaderText" class="ft-loader-text">Traitement en cours...</div>
	  </div>
	</div>
	
	
	    <script th:src="@{/js/bootstrap.bundle.min.js}"></script>
		<script th:src="@{/js/ft-theme.js}"></script>
	

 </footer>


</body>
</html>
